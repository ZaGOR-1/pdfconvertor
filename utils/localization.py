"""
Localization System - –°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—ó
=========================================

–¢–µ–∫—Å—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é.
"""

from typing import Dict, Any


class Localization:
    """Singleton –∫–ª–∞—Å –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–µ–∫—Å—Ç–∞–º–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É."""
    
    _instance = None
    
    def __new__(cls):
        if cls._instance is None:
            cls._instance = super().__new__(cls)
            cls._instance._initialized = False
        return cls._instance
    
    def __init__(self):
        """–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å–∏—Å—Ç–µ–º–∏ –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—ó."""
        if self._initialized:
            return
            
        self._initialized = True
        self._translations = self._load_translations()
    
    def _load_translations(self) -> Dict[str, str]:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—ñ–≤.
        
        Returns:
            –°–ª–æ–≤–Ω–∏–∫ –∑ —Ç–µ–∫—Å—Ç–∞–º–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
        """
        return {
                # –ì–æ–ª–æ–≤–Ω–µ –≤—ñ–∫–Ω–æ
                "app_title": "Word to PDF Converter",
                "ready": "–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
                
                # –ö–Ω–æ–ø–∫–∏
                "btn_add_files": "üìÅ –î–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏",
                "btn_convert": "üîÑ –ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏",
                "btn_clear": "üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
                "btn_settings": "‚öôÔ∏è",
                "btn_stop": "‚è∏Ô∏è –ó—É–ø–∏–Ω–∏—Ç–∏",
                
                # Drag & Drop –∑–æ–Ω–∞
                "drop_zone_title": "–ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å —Ñ–∞–π–ª–∏ –∞–±–æ –ø–∞–ø–∫–∏ —Å—é–¥–∏ –∞–±–æ –∫–ª–∞—Ü–Ω—ñ—Ç—å",
                "drop_zone_subtitle": "–í–∏–±–µ—Ä—ñ—Ç—å DOC/DOCX —Ñ–∞–π–ª–∏ –∞–±–æ –ø–∞–ø–∫–∏ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏",
                "drop_zone_formats": "–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏: DOC, DOCX ‚Ä¢ –ü–∞–ø–∫–∏: —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π –ø–æ—à—É–∫",
                
                # –°—Ç–∞—Ç—É—Å–∏
                "status_ready": "‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
                "status_processing": "üîÑ –û–±—Ä–æ–±–∫–∞...",
                "status_completed": "‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ",
                "status_stopped": "‚è∏Ô∏è –ó—É–ø–∏–Ω–µ–Ω–æ",
                "status_error": "‚ùå –ü–æ–º–∏–ª–∫–∞",
                "status_files_added": "‚úÖ –î–æ–¥–∞–Ω–æ {count} —Ñ–∞–π–ª(—ñ–≤)",
                "status_no_word_files": "‚ö†Ô∏è –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ Word –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤",
                "status_list_cleared": "üóëÔ∏è –°–ø–∏—Å–æ–∫ –æ—á–∏—â–µ–Ω–æ",
                "status_settings_saved": "‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ",
                "status_conversion_complete": "‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞: —É—Å–ø—ñ—à–Ω–æ {success}, –ø–æ–º–∏–ª–æ–∫ {failed}",
                "status_stopping": "‚è∏Ô∏è –ó—É–ø–∏–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó...",
                "status_selecting_files": "üìÅ –í–∏–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤...",
                "status_file_removed": "üóëÔ∏è –§–∞–π–ª –≤–∏–¥–∞–ª–µ–Ω–æ: {name}",
                "status_theme_changed": "üé® –¢–µ–º—É –∑–º—ñ–Ω–µ–Ω–æ –Ω–∞ {theme}",
                "theme_dark": "—Ç–µ–º–Ω—É",
                "theme_light": "—Å–≤—ñ—Ç–ª—É",
                
                # –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                "msg_no_files": "–ù–µ–º–∞—î —Ñ–∞–π–ª—ñ–≤",
                "msg_no_files_desc": "–ë—É–¥—å –ª–∞—Å–∫–∞, –¥–æ–¥–∞–π—Ç–µ Word —Ñ–∞–π–ª–∏ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó",
                "msg_converting": "–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –≤ –ø—Ä–æ—Ü–µ—Å—ñ",
                "msg_converting_desc": "–ó–∞—á–µ–∫–∞–π—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó",
                "msg_convert_confirm": "–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è",
                "msg_convert_question": "–ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ {count} —Ñ–∞–π–ª(—ñ–≤) —É PDF?",
                "msg_stop_title": "–ó—É–ø–∏–Ω–∏—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—é",
                "msg_stop_question": "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑—É–ø–∏–Ω–∏—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—é?",
                "msg_stopped_title": "–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –∑—É–ø–∏–Ω–µ–Ω–∞",
                "msg_stopped_text": "‚è∏Ô∏è –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—é –∑—É–ø–∏–Ω–µ–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º\n\n‚úÖ –£—Å–ø—ñ—à–Ω–æ: {success}\n‚ùå –ü–æ–º–∏–ª–æ–∫: {failed}\nüìä –í—Å—å–æ–≥–æ: {total}",
                "msg_complete_title": "–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞",
                "msg_complete_success": "‚úÖ –í—Å—ñ —Ñ–∞–π–ª–∏ ({success}) —É—Å–ø—ñ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–æ!",
                "msg_complete_errors": "–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∑ –ø–æ–º–∏–ª–∫–∞–º–∏",
                "msg_complete_stats": "‚úÖ –£—Å–ø—ñ—à–Ω–æ: {success}\n‚ùå –ü–æ–º–∏–ª–æ–∫: {failed}\nüìä –í—Å—å–æ–≥–æ: {total}",
                
                # –î—ñ–∞–ª–æ–≥–∏
                "dialog_select_files": "–í–∏–±–µ—Ä—ñ—Ç—å Word –¥–æ–∫—É–º–µ–Ω—Ç–∏",
                "filetype_word_docs": "Word –¥–æ–∫—É–º–µ–Ω—Ç–∏",
                "filetype_doc": "DOC —Ñ–∞–π–ª–∏",
                "filetype_docx": "DOCX —Ñ–∞–π–ª–∏",
                "filetype_all": "–í—Å—ñ —Ñ–∞–π–ª–∏",
                
                # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
                "settings_title": "‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
                "settings_conversion": "‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó",
                "settings_pdf": "üìÑ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è PDF",
                "settings_compression": "üóúÔ∏è –°—Ç–∏—Å–Ω–µ–Ω–Ω—è",
                "settings_general": "üîß –ó–∞–≥–∞–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
                "settings_language": "üåê –ú–æ–≤–∞",
                
                "setting_quality": "–Ø–∫—ñ—Å—Ç—å PDF:",
                "setting_orientation": "–û—Ä—ñ—î–Ω—Ç–∞—Ü—ñ—è:",
                "setting_page_size": "–†–æ–∑–º—ñ—Ä —Å—Ç–æ—Ä—ñ–Ω–∫–∏:",
                "setting_compression": "–£–≤—ñ–º–∫–Ω—É—Ç–∏ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è PDF (–∑–º–µ–Ω—à—É—î —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É)",
                "setting_compression_level": "–†—ñ–≤–µ–Ω—å —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è:",
                "setting_ask_overwrite": "–ó–∞–ø–∏—Ç—É–≤–∞—Ç–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ñ —ñ—Å–Ω—É—é—á–∏—Ö —Ñ–∞–π–ª—ñ–≤",
                "setting_notifications": "–ü–æ–∫–∞–∑—É–≤–∞—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó",
                "setting_max_size": "–ú–∞–∫—Å. —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (–ú–ë):",
                "setting_language_label": "–ú–æ–≤–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É:",
                
                "quality_low": "–ù–∏–∑—å–∫–∞ (–º–µ–Ω—à–∏–π —Ä–æ–∑–º—ñ—Ä)",
                "quality_standard": "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞",
                "quality_high": "–í–∏—Å–æ–∫–∞",
                "quality_maximum": "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ (–≤–µ–ª–∏–∫–∏–π —Ä–æ–∑–º—ñ—Ä)",
                
                "orientation_portrait": "üìÑ –ü–æ—Ä—Ç—Ä–µ—Ç–Ω–∞",
                "orientation_landscape": "üìÉ –ê–ª—å–±–æ–º–Ω–∞",
                
                "btn_save": "üíæ –ó–±–µ—Ä–µ–≥—Ç–∏",
                "btn_cancel": "‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏",
                "btn_reset": "üîÑ –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º",
                
                # –ß–∞—Å
                "time_seconds": "—Å–µ–∫",
                "time_minutes": "—Ö–≤",
                "time_label": "–ß–∞—Å:",
                
                # –°—Ç–∞—Ç—É—Å–∏ —Ñ–∞–π–ª—ñ–≤
                "file_pending": "‚è≥ –û—á—ñ–∫—É–≤–∞–Ω–Ω—è",
                "file_converting": "üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è...",
                "file_completed": "‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ",
                "file_failed": "‚ùå –ü–æ–º–∏–ª–∫–∞",
                "file_stopped": "‚è∏Ô∏è –°–∫–∞—Å–æ–≤–∞–Ω–æ",
                
                # –ü–æ–º–∏–ª–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
                "error_file_not_exists": "–§–∞–π–ª –Ω–µ —ñ—Å–Ω—É—î",
                "error_not_a_file": "–¶–µ –Ω–µ —Ñ–∞–π–ª",
                "error_unsupported_format": "–ù–µ–ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç",
                "error_file_too_large": "–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π",
        }
    
    def get(self, key: str, **kwargs) -> str:
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –∑–∞ –∫–ª—é—á–µ–º.
        
        Args:
            key: –ö–ª—é—á —Ç–µ–∫—Å—Ç—É
            **kwargs: –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ä—è–¥–∫–∞
            
        Returns:
            –¢–µ–∫—Å—Ç —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
        """
        translation = self._translations.get(key, key)
        
        # –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è, —è–∫—â–æ —î –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
        if kwargs:
            try:
                return translation.format(**kwargs)
            except KeyError:
                return translation
        
        return translation
